---
- name: Apt cache update
  apt: update_cache=yes cache_valid_time=120
  tags:
    - ihtsdo-asset

- name: Install ts-delta-import-process package
  apt: name=ts-delta-import-process state=installed
  notify:
    - restart ts-delta-import-process
  when: orchestration_service_version == 'installed'
  tags:
    - ihtsdo-asset
    
- name: Install latest ts-delta-import-process package
  apt: name=ts-delta-import-process state=latest
  notify:
    - restart ts-delta-import-process
  when: orchestration_service_version == 'latest'
  tags:
    - ihtsdo-asset

- name: Install ts-delta-import-process package specific version
  apt: name=ts-delta-import-process={{ orchestration_service_version }} state=installed
  notify:
    - restart ts-delta-import-process
  when: orchestration_service_version != 'installed' and orchestration_service_version != 'latest'
  tags:
    - ihtsdo-asset

- name: Configure
  template: src=application.properties.j2 dest=/etc/opt/ts-delta-import-process/application.properties
            owner=root group=ts-delta-import-process mode=0640
  notify:
    - restart ts-delta-import-process
  tags:
    - ihtsdo-asset



