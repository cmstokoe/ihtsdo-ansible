---
# Creates database user for jira  with all database privileges and 'WITH GRANT OPTION'
- name: Create default database user for application 
  mysql_user: name={{ mysql_user }} password={{ mysql_password }} login_user=root login_password={{ mysql_root_password }} priv=*.*:ALL,GRANT state=present

# Create the database
- name: Create default database
  mysql_db: name={{mysql_db}} login_user={{mysql_user}} login_password={{mysql_password}} encoding=utf8 state=present

# Configure mysql database server in jira
- name: Configure application to use mysql 
  template: src=templates/dbconfig.xml.j2 dest={{common_home}}/{{atlassian_application}}/dbconfig.xml owner={{ system_user }} group={{ system_group }}
  when: atlassian_application == "jira"
