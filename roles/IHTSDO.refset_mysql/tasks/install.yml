---
#tomcat7  
       
- name: Install package
  apt: name={{refset_app_name}} state=installed
  when: refset_version == 'installed'

- name: Install latest package
  apt: name={{refset_app_name}} state=latest
  when: refset_version == 'latest'

- name: Install package specific version
  apt: name={{refset_app_name}}={{ refset_version }} state=installed
  when: refset_version != 'installed' and refset_version != 'latest'
  
- name: Ensure group exists
  group: name={{ refset_user }} state=present

- name: Ensure user exists
  user: name={{ refset_user }} group={{ refset_user }} state=present
  
- name: set perms
  file: path="{{ refset_app_dir }}" state=directory
        owner={{ refset_user }} group="{{ refset_user }}" mode=755 
        recurse=yes  

- name: set perms for indexes dir
  file: path="{{ indexBase_dir }}" state=directory
        owner={{ refset_user }} group="{{ refset_user }}" mode=755 
        recurse=yes   
        
- name: Configure config.properties
  template: src=config.properties.j2 dest={{refset_app_dir}}/conf/config.properties
            owner={{refset_user}} group={{refset_user}} mode=0640        